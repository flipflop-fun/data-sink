# graph-mainnet
graph-mainnet.flipflop.plus {
  encode zstd gzip

  # 预检匹配
  @preflight method OPTIONS

  # 统一 CORS 头（按需把 * 换成你的白名单域）
  header {
    Access-Control-Allow-Origin *
    Access-Control-Allow-Methods "GET,HEAD,POST,OPTIONS"
    Access-Control-Allow-Headers *
    Access-Control-Max-Age 86400
    # 将这些头也应用于反向代理后的响应
    defer
  }

  # 预检直接 204
  respond @preflight "" 204

  # 反代到容器内的 mainnet 服务端口（确保与服务实际监听一致）
  reverse_proxy flipflop-graph-mainnet:5050
}

# graph-devnet
graph-devnet.flipflop.plus {
  encode zstd gzip

  @preflight method OPTIONS

  header {
    Access-Control-Allow-Origin *
    Access-Control-Allow-Methods "GET,HEAD,POST,OPTIONS"
    Access-Control-Allow-Headers *
    Access-Control-Max-Age 86400
    defer
  }

  respond @preflight "" 204

  reverse_proxy flipflop-graph-devnet:5051
}